<?xml version="1.0" ?>
<doc>
	<label auto="true" type="str" verify="true"><![CDATA[Develop]]></label>
	<author auto="true" type="list" verify="true">
		<item type="str"><![CDATA[bodyawm]]></item>
	</author>
	<date auto="true" type="str" verify="true"><![CDATA[2022-12-16, 11:01]]></date>
	<link auto="true" type="str" verify="true"><![CDATA[https://habr.com/ru/company/timeweb/blog/705298/]]></link>
	<title auto="true" type="str" verify="true"><![CDATA[Я купил смартфон за 500 рублей, а он оказался с подвохом. Делаем из него домашний сервер]]></title>
	<categories auto="true" type="list" verify="true">
		<item type="str"><![CDATA[Блог компании Timeweb Cloud]]></item>
		<item type="str"><![CDATA[Разработка под Android]]></item>
		<item type="str"><![CDATA[Гаджеты]]></item>
		<item type="str"><![CDATA[Смартфоны]]></item>
	</categories>
	<key_words auto="true" type="list" verify="true">
		<item type="str"><![CDATA[timeweb_статьи]]></item>
		<item type="str"><![CDATA[смартфоны]]></item>
		<item type="str"><![CDATA[гаджеты]]></item>
		<item type="str"><![CDATA[Android]]></item>
		<item type="str"><![CDATA[MP3]]></item>
		<item type="str"><![CDATA[Samsung Galaxy]]></item>
		<item type="str"><![CDATA[J3]]></item>
		<item type="str"><![CDATA[SIM]]></item>
		<item type="str"><![CDATA[MicroSD]]></item>
		<item type="str"><![CDATA[IMEI]]></item>
		<item type="str"><![CDATA[FRP]]></item>
		<item type="str"><![CDATA[dlna-сервер]]></item>
		<item type="str"><![CDATA[mysql]]></item>
		<item type="str"><![CDATA[php]]></item>
		<item type="str"><![CDATA[веб-сервер]]></item>
		<item type="str"><![CDATA[ftp-сервер]]></item>
		<item type="str"><![CDATA[Flash]]></item>
	</key_words>
	<text auto="true" type="str" verify="true"><![CDATA[К сожалению, не все покупки с пересылкой в другой город на онлайн-барахолках удачные. Иногда продавцы умалчивают серьёзные дефекты ништяков, а на почте всё проверить невозможно: ведь очередь тоже ждать не будет! Так и случилось в рамках сегодняшней статьи, когда я заказал Samsung Galaxy J3 и S4 за 1.000 рублей, а у них обоих оказались очень серьёзные косяки, о которых продавец конечно же умолчал! У J3 был сколот дисплей (на фотографии не было видно), он стоял на пароле (об этом было оговорено заранее) и у него варварски, вместе с пятачками был выдран один из сим-лотков! Но он отнюдь не бесполезен и из него можно сделать вполне себе полноценный сервер. Как? Читайте в статье!



❯ Предыстория

Начинаем, как обычно, с небольшой предыстории! Я регулярно листаю популярные онлайн-барахолки и заказываю интересующие меня лоты. У меня есть особый список ништяков, которые я хотел бы заполучить в первую очередь и заказываю их практически моментально. Вероятно те, кто читают мои статьи довольно давно, знают мою особенную любовь к старым смартфонам Samsung. Настолько особенную, что я даже посвятил большой лонгрид сравнения оригинального S3 с его китайскими подделками!

Так случилось и неделю назад, я наткнулся на интересный лот с двумя смартфонами: Samsung Galaxy J3 2016 года выпуска и Samsung Galaxy S4 2013 года выпуска. Пообщавшись с продавцом и поинтересовавшись за их неисправности, я получил ответ «ну оба на пороле стоят!».


S4 слева и J3 справа

Заказ оформлен. Прошла неделя, я пошёл на почту получить свои новые ништячки и был неприятно удивлён колотым дисплеем J3. Я имел право отказаться от посылки, но у S4 дисплей был просто в идеальном состоянии, даже с плёнкой, поэтому я решил забрать посылку. Дома меня ждал неприятный сюрприз: у обоих смартфонов были выдраны слоты под сим-карту. И если в случае S4 это не проблема, поскольку там слот под MicroSD и SIM расположены на отстёгиваемом шлейфе, то у J3 один из слотов вырван с пятаками, да и дисплей у него регулярно покрывается полосами.




Два пятачка вырваны — тут только подпаиваться к дорожке!

Забрал бы я заказ, зная эти косяки заранее? Скорее да и всё дело в S4, который был в очень хорошем состоянии. Дисплеи на него стоят сейчас 1.000 рублей, а шлейф можно достать с донора! Им похоже вообще не пользовались: забыли пароль лет эдак 8 назад и положили на полку.




Не беда — донор с битым дисплеем будет стоить рублей 300

На S4 пароль сбрасывается легко: при выключенном смартфоне заходим в рекавери сочетанием клавиш «громкость вверх + домой + питание» и делаем Wipe Cache/Wipe Data. Перезагружаемся, настраиваем по новой и кода уже нет.

С J3, однако, всё несколько сложнее. С 5 версии в Android появился FRP: что-то типа аналога iCloud, только обходится он куда проще, достаточно лишь стереть данные о владельце в специальном разделе «FRP». У Apple же информация о привязке хранится на их серверах в виде пары серийный номер/IMEI (и при замене модема без замены памяти и всего остального у нас будет ошибка активации). Однако, благодаря багам оболочки Samsung, можно легко обойти экран активации. Но как это сделать?

❯ Обход блокировки

Стоит отметить, что данная инструкция применима к S5/S6/J6/J1, т. е. практически ко всем устройствам Samsung 2014-2016 года выхода. Точно таким же образом, я купил в апреле Galaxy J5 2016 в отличном состоянии, всего лишь за 200 российских рублей(~5-7$) и ходил с ним как с основным. На других устройствах всё по другому, например на устройствах с чипами MediaTek, зачастую достаточно лишь заполнить нулями область FRP стоковым флэшером.

Итак, включаем смартфон и вот у нас экран активации. Активируем функцию TalkBack, нажимая три раза подряд кнопку Home. Затем делаем свайп от верха экрана вниз и затем направо. Откроется контекстное меню TalkBack, жмём там «Настройки». Листаем до «лицензионного соглашения» и… смартфон предлагает нам открыть браузер! Отлично!



Заходим на какой-нибудь сайт, где можно скачать сторонний лаунчер. Я выбрал старый добрый spaces. Качаем лаунчер и устанавливаем его, перед этим предложит активировать установку программ из неизвестных источников, на что мы соглашаемся. Затем обязательно запускаем лаунчер из экрана установки.





Узнали? Эта версия из 2011 года вполне сочетается с плоским интерфейсом 5 андроида, да и работает шустрее встроенного лаунчера! Я с момента обхода блокировки его и оставил на своём j5!

Затем вводим код (+30012012732+, обязательно со скобкой, это не опечатка. Откроется меню выбора типа подключения по USB, мы выбираем ADB + MTP и уходим в ребут.



Подключаем смартфон, устанавливаем драйвера adb, если они не установлены и с помощью утилиты в архиве ниже (run.exe) обходим блокировку. Настраиваем смартфон как обычно. Теперь смартфон считается чистым, без каких либо привязок, всё легко и просто!

disk.yandex.ru/d/G_m0DHjmh9EKoA

Ура! Смартфон отвязан и теперь им можно пользоваться как обычно. Правда одно сим-лотка нет… но мы представим что нет и второго, или у нашего устройства отвал 3G модема!



❯ Применяем в быту

Итак, для чего может пригодится смартфон, у которого разбит дисплей, но работает тачскрин, у которого нет слота для сим-карты, но исправен Wi-Fi модуль и который был 5 минут назад привязан к чужому аккаунту? Может, в качестве веб-сервера? Применений масса, точно также, как на Symbian портировали серверы, их портировали и на Android!

Для того, чтобы запустить большинство серверов, нам необходим root доступ. Для этого, в случае j3 (именно j310f/j310fn, для других моделей ищите свой recovery) нам нужно прошить кастомное рекавери TWRP, а затем прошить архив SuperSU, который сам пропатчит загрузчик и установит su!

disk.yandex.ru/d/s3WfV57OLLPqyA?ref=dtf.ru

supersuroot.org/downloads/SuperSU-v2.82-201705271822.zip

Качаем файлы по ссылкам выше и заходим в настройки смартфона. Включаем режим разработчика, тапнув 7 раз по пункту «номер сборки» в «о устройстве» и включаем разблокировку, предусмотренную производителем.



Перезагружаемся в режим Odin — это специальный прошивочный режим смартфонов Samsung, который предустановлен на всех устройствах, вне зависимости от их чипсета. Для прошивки нам нужен фирменный флэшер — Odin.



Выбираем в пункте AP наш рекавери и снимаем галочку «Reboot». Смартфон выключаем и снова включаем зажатием громкости вниз + домой + включения. Появится меню с предупреждением, нажимаем громкость вверх. Подключаем устройство к ПК, при необходимости ставим драйвера и жмём Start в Odin. После прошивки раздела recovery, перетыкаем аккумулятор и включаем устройство нажатием «громкость вверх + домой + включение». После загрузки TWRP, нам необходимо установить архив с root, выбрав Install Update From ZIP. Есть ещё вариант с установкой через sideload с ПК, для этого идём в Advanced -> ADB Sideload и свайпаем ползунок. На ПК пишем adb sideload <имя архива>.



После окончания процесса, устройство необходимо перезагрузить. Ура, теперь у нас есть root!



Итак, устройств свободно от блокировок и на нём есть root доступ. Что с ним можно сделать?

Например, можно поднять FTP сервер и использовать смартфон в качестве небольшой файловой помойки(32-64гб в случае моделей высокого класса, но в случае j3, встроенной памяти всего 4гб поскольку это бюджетник) с встроенным кард-ридером! Скорость MMC интерфейса смартфона несравнимо выше скорости кард-ридеров в дешёвых хабах, поскольку на один MMC интерфейс зачастую цепляется и внутренняя Flash память (которая спокойно работает 100-200мб/с), так и флэшка. Кроме того, такое решение обычно надежнее жёстких дисков, поскольку при износе флэш-память обычно уходит в readonly, но даёт прочитать из себя память. Даже если для этого потребуется вмешательство СЦ (но зачастую достаточно поставить кастомное рекавери, дабы иметь возможность всегда вытащить файлы).

FTP серверов для Android существует множество. Я выбрал FTP Server Pro, он работает практически из коробки. Если нужен только локальный доступ, то можно даже оставить анонимный вход. Но лучше всё же поставить пароль =)



Под Windows FTP-сервер можно добавить в сетевое окружение и он будет виден формально как жёсткий диск. Есть возможно примонтировать его и как физический жёсткий диск, тогда оттуда можно будет запускать даже софт!





Но всё же, некоторым пользователям привычнее SAMBA. Более того, её можно «из коробки» примонтировать в linux в качестве физического диска, как и в Windows. Все серверы SAMBA на Android, что я использовал, поддерживали только SMB1, который в современных версиях Windows по умолчанию отключён. Для его включения запускаем PowerShell от имени администратора и пишем вот такую команду:



Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol

Теперь можно добавить сетевой диск и назначить ему букву, только не забудьте указать логин и пароль!

На Android я использовал программу SambaDroid!





Ага, с SMB разобрались. Как насчёт web-сервера и PHP? Сразу скажу: у меня скопилось много смартфонов на Android с какими-либо дефектами, а поскольку я люблю мультиплеерные игры и писать сетевой код, то для одного из своих проектов я хотел сделать кластер… из старых смартфонов на Android! Серьёзно, для матчмейкинга в качестве официальных смартфонов использовались бы обычные смартфоны! =)

Но здесь уже вопросы оптимизации игровых серверов, их авторитарности и кол-ва обрабатываемой информации, а это тема отдельной статьи.

В качестве веб-сервера на смартфоне я использовал Bit Web Server, но он относительно глючный. Это сборная солянка из mysql, php и веб-сервера, он вполне себе подойдет для хостинга домашней странички, или, например таблицы рекордов для вашей игры.



На самом деле, есть заметный плюс от такого сервера: если вдруг выключат свет, то аккумулятор смартфона выступит в роли ИБП. Причём не на 15 минут, а на несколько часов. Мелочь, а приятно.



Есть возможность использовать смартфон в качестве DLNA-сервера и хранить там, например, семейные фотографии. Иногда в смартфонах есть встроенные средства для этого, иногда нужно ставить сторонний сервер. Однако одними фотографиями применение не ограничиваются: например можно сделать спотифай у себя дома, и слушать музыку с любых устройств. Весьма удобно!



И это уже не говоря о типичных способах применения а-ля использования в качестве навигатора или MP3 плеера в машину. У J3 также достаточно свежая версия Android, чтобы пользоваться банковскими приложениями. Так разве ж такой ништяк бесполезен? Надеюсь, эта статья поможет кого-то мотивировать не выкидывать старый смартфон, а использовать его в нужном русле: ведь применений действительно много! Лично как по мне, у подобного устройства ещё куча применений, даже если он в плачевном состоянии!? А ваше мнение?       ❯ Предыстория ❯ Предыстория        S4 слева и J3 справа S4 слева и J3 справа S4 слева и J3 справа          Два пятачка вырваны — тут только подпаиваться к дорожке! Два пятачка вырваны — тут только подпаиваться к дорожке! Два пятачка вырваны — тут только подпаиваться к дорожке!          Не беда — донор с битым дисплеем будет стоить рублей 300 Не беда — донор с битым дисплеем будет стоить рублей 300 Не беда — донор с битым дисплеем будет стоить рублей 300       ❯ Обход блокировки ❯ Обход блокировки                   обязательно        disk.yandex.ru/d/G_m0DHjmh9EKoA        ❯ Применяем в быту ❯ Применяем в быту      disk.yandex.ru/d/s3WfV57OLLPqyA?ref=dtf.ru   supersuroot.org/downloads/SuperSU-v2.82-201705271822.zip                                             Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol                                   ]]></text>
</doc>
