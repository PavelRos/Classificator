<?xml version="1.0" ?>
<doc>
	<label auto="true" type="str" verify="true"><![CDATA[Other]]></label>
	<author auto="true" type="list" verify="true">
		<item type="str"><![CDATA[netsvetaev]]></item>
	</author>
	<date auto="true" type="str" verify="true"><![CDATA[2022-11-13, 01:50]]></date>
	<link auto="true" type="str" verify="true"><![CDATA[https://habr.com/ru/post/698998/]]></link>
	<title auto="true" type="str" verify="true"><![CDATA[Я обучил нейросеть на своих рисунках и отдаю модель бесплатно (и научу вас делать это)]]></title>
	<categories auto="true" type="list" verify="true">
		<item type="str"><![CDATA[Python]]></item>
		<item type="str"><![CDATA[Обработка изображений]]></item>
		<item type="str"><![CDATA[Машинное обучение]]></item>
		<item type="str"><![CDATA[Графический дизайн]]></item>
		<item type="str"><![CDATA[Искусственный интеллект]]></item>
	</categories>
	<key_words auto="true" type="list" verify="true">
		<item type="str"><![CDATA[ai]]></item>
		<item type="str"><![CDATA[stablediffusion]]></item>
		<item type="str"><![CDATA[invokeai]]></item>
		<item type="str"><![CDATA[neural networks]]></item>
		<item type="str"><![CDATA[neural paintings]]></item>
		<item type="str"><![CDATA[image processing]]></item>
		<item type="str"><![CDATA[graphic design]]></item>
		<item type="str"><![CDATA[нейросети]]></item>
		<item type="str"><![CDATA[art]]></item>
		<item type="str"><![CDATA[machinelearning]]></item>
	</key_words>
	<text auto="true" type="str" verify="true"><![CDATA[Модель подходит для создания бесшовных узоров, абстрактных рисунков и стилизованных под акварель образов. Как использовать модель и как обучить нейросеть на своих картинках?
Скачать модель здесь
Как использовать .ckpt модель
Качаете файл .ckpt, кидаете в папку с моделями — а дальше все зависит от форка, который вы используете. В InvokeAI, которым пользуюсь я, модели добавляются обычной загрузкой invoke.py и выполнением команды !import_model в консоли.
Как обучить нейросеть на своих картинках, если нет нвидии 4090
У гугла есть замечательный сервис colab — гугл дает бесплатное железо примерно на час. Этого достаточно, чтобы создать модель на основе 15-30-50 изображений.
Сначала идем сюда и знакомимся с колабом (но ничего не трогаем): https://colab.research.google.com/github/ShivamShrirao/diffusers/blob/main/examples/dreambooth/DreamBooth_Stable_Diffusion.ipynb
Все, что требуется от пользователя, кроме прокликивания каждого окна с кодом и загрузки картинок, — ключ от hugging face. 
Регистрируемся на huggingface.co, а затем создаем ключ в настройках https://huggingface.co/settings/tokens
Ключ вставляем сюда:
Отмечаем сохранение модели в гуглдрайв и указываем папку, если хотите (она создастся автоматически, в ней будет лежать модель)
Далее указываем, как будем вызывать свой стиль или объект
Конкретный токен не так важен, но главное, чтобы вы сами это запомнили. И если он будет коротким — вам будет проще вписывать его в запрос.
Затем загружаем картинки:
У загрузчика есть проблемы с сафари, лучше загружать из хрома. Или сначала добавить картинки в папку на гугл-диске, а потом указать путь до нее.
Нужно использовать размер 512x512 и лучше подготовить изображения заранее. Что вырезать — решайте сами, но я рекомендую вырезать так, чтобы сохранялась композиция и значимые объекты целиком. Можно сделать несколько отдельных картинок с увеличенным масштабом.
Пример изображений для моей модели
В зависимости от количества изображений, можно изменить количество шагов обучения. Разумное количество — 100 шагов * количество картинок. Для 8 картинок — а хватит и 8 — достаточно 800 шагов. Слишком много шагов тоже плохо: генерации станут слишком контрастными и на них появятся артефакты.
Далее просто запускайте каждый блок в колабе кнопкой Play в левом верхнем углу и здите завершения каждого кода. Когда доберетесь до участка, показанного выше, увидите процесс обучения. Он займет примерно 10 минут + еще 10-30 минут, в зависимости от количества картинок и шагов.
После обучения можно проверить модель на тестовой генерации и сконвертировать в формат .ckpt:
Теперь файл у вас на диске — скачивайте и добавляйте в любимый форк.
Дополнительно можно удалить лишние файлы и завершить процесс
О себе: Меня зовут Артур Нецветаев, я менеджер продуктов, предприниматель и дизайнер интерфейсов. Я помогаю с разработкой интерфейса InvokeAI и пользуюсь им сам с момента создания. Модель подходит для создания бесшовных узоров, абстрактных рисунков и стилизованных под акварель образов. Как использовать модель и как обучить нейросеть на своих картинках? Как использовать модель и как обучить нейросеть на своих картинках? Скачать модель здесь Скачать модель здесь Скачать модель здесь     ]]></text>
</doc>
