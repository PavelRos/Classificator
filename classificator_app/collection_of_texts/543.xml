<?xml version="1.0" ?>
<doc>
	<label auto="true" type="str" verify="true"><![CDATA[Develop]]></label>
	<author auto="true" type="list" verify="true">
		<item type="str"><![CDATA[kirillkosolapov]]></item>
	</author>
	<date auto="true" type="str" verify="true"><![CDATA[2022-12-01, 08:37]]></date>
	<link auto="true" type="str" verify="true"><![CDATA[https://habr.com/ru/company/amvera/blog/702424/]]></link>
	<title auto="true" type="str" verify="true"><![CDATA[Пушкин – это нейросеть? Учимся распознавать сгенерированный текст]]></title>
	<categories auto="true" type="list" verify="true">
		<item type="str"><![CDATA[Блог компании Amvera]]></item>
		<item type="str"><![CDATA[Семантика]]></item>
		<item type="str"><![CDATA[Математика]]></item>
		<item type="str"><![CDATA[Машинное обучение]]></item>
		<item type="str"><![CDATA[Искусственный интеллект]]></item>
	</categories>
	<key_words auto="true" type="list" verify="true">
		<item type="str"><![CDATA[Выявление сгенерированного текста]]></item>
		<item type="str"><![CDATA[Определение сгенерированного текста]]></item>
		<item type="str"><![CDATA[amvera]]></item>
		<item type="str"><![CDATA[amvera cloud]]></item>
	</key_words>
	<text auto="true" type="str" verify="true"><![CDATA[С появлением в 2020 году нейронной сети GPT3 и других архитектур – трансформеров, генерируемые тексты стали невероятно правдоподобными. Такими правдоподобными, что отдельно взятый текст, не несущий большой смысловой нагрузки, стало сложно отличить от написанного человеком. В статье мы разберем подход к определению сгенерированных текстов. И заодно выясним, является ли, по мнению алгоритма, Пушкин (и другие деятели искусства) искусственной нейронной сетью.
Суть подхода
Суть подхода заключается в том, чтобы 
выявить признаки, характеризующие сгенерированный текст, 
собрать обучающую выборку, 
с помощью одного из алгоритмов машинного обучения сделать предсказание.
Текст токенизуется, затем переводится в вектор, строятся матрицы внимания с использованием переобученного BERT, строятся фильтрованные графы на основе признаков внимания. Затем определяются топологические и метрические признаки, которые направляются на вход алгоритму классификации.
Если вы хотите подробнее прочитать про механизм внимания, то можно воспользоваться этой статьей.
Данные для обучения
Для обучения использовалось тексты из соревнования на Kaggle, сгенерированные нейронными сетями.
А теперь рассмотрим механизм подробнее. ОСТОРОЖНО, МНОГО МАТЕМАТИКИ!)
Все равно хочу увидеть
Результаты классификации по метрике accuracy
В качестве алгоритма была использована логистическая регрессия, как наиболее просто интерпретируемый подход.
Accuracy
Топологические признаки: 0.6291
Штрихкодовые признаки: 0.6227
Метрические признаки: 0.6276
Все признаки: 0.6429
Проверяем великих писателей на сгенерированность текста 
А.С. Пушкин
Проверено текстов 5.
Классифицировано как сгенерированные тексты - 3.
Пример матрицы внимания.
Пример для строк «Мой дядя самых честных правил …»
Классифицированы как сгенерированные нейронной сетью:
1.     Буря мглою небо кроет, вихри снежные крутя…
2.     Мой дядя самых честных правил …
3.     Последняя туча рассеянной бури! Одна ты несешься по ясной лазури … 
Возьмем что-то более сложное и неочевидное
В.В. Маяковский
Проверено текстов 5.
Классифицировано как сгенерированные тексты - 2.
Пример матрицы внимания.
Пример для строк «Я волком выгрыз бы бюрократизм…»
Классифицированы как сгенерированные нейронной сетью:
1. Били копыта, пели будто: — Гриб. Грабь. Гроб. Груб …
2. В шатрах, истертых ликов цвель …
А.А. Блок
Проверено текстов 5.
Классифицировано как сгенерированные тексты - 0.
Пример матрицы внимания.
Пример для строк “ночь, улица, фонарь, аптека …»
Пока получилось не очень наглядно, тексты слишком длинные. Попробуем что-нибудь из современного, лично я всегда подозревал стихи группы Мельница в том, что они сгенерированы. Проверим это!
Группа Мельница
Проверено текстов 5.
Классифицировано как сгенерированные тексты - 0.
Пример матрицы внимания.
Пример для строк «Есть такие дороги – назад не ведут...» 
Тут видно, что слова прилив и морская связаны.
И напоследок немного русского рока. 
Машина времени
Проверено текстов 5.
Классифицировано как сгенерированные тексты - 0.
Пример матрицы внимания.
Пример для строк «Крысы придумали мир для крыс…»
В этом примере видно, как «внимание» сосредотачивается на повторяющихся словах. 
Анализруем стихи, сгенерированные нейронной сетью
Таким образом стихи, проанализированные алгоритмом, были верно классифицированы, за исключением 3 из 5 стихов Пушкина и 2 из 5 стихов Маяковского. Но кто знает – может это и не ошибка;)
А может, дело в самой форме – стихотворения. Давайте попробуем взять стихи, сгенерированные нейронной сетью, и посмотреть, что скажет алгоритм. Сами текст мы возьмем из нашей предыдущей статьи – Используем нейросеть для генерации стихов в стиле «Евгения Онегина.
Мы проанализировали 9 текстов, созданных нейронной сетью, и получили 8 верных предсказаний. Результаты можно найти под спойлером в таблице предсказаний.
Итоговая таблица предсказаний. H - человек, М - машина.











Выводы
Мы рассмотрели алгоритм определения сгенерированных текстов, которые на «человеческий взгляд» выглядят весьма натурально. На данный момент подход дает прогноз с accuracy 0,64, что выше случайного предсказания. При этом алгоритм принял за сгенерированные нейронной сетью большинство из стихов Пушкина и почти половину стихов Маяковского. Как говорится – совпадение? не думаю … 
Статья написана на основе работ 1, 2, 3 Александры Штаревой и Екатерины Артемовой.
Если вы хотите ознакомиться с кодом проекта, то это можно сделать по ссылке.
А если хотите этот проект (или любой другой ваш проект) развернуть, захостить и протестировать, то можно воспользоваться нашим контейнерным Heroku-подобным облаком Amvera, с возможностью доставки обновлений через push в GIT. Для этого нужно зарегистрироваться, после чего на счет будет зачислено 1 т.р., и ввести до 5 декабря 2022 г. промокод HabrNNText, который зачислит еще 300 руб. на счет.  С появлением в 2020 году нейронной сети GPT3 и других архитектур – трансформеров, генерируемые тексты стали невероятно правдоподобными. Такими правдоподобными, что отдельно взятый текст, не несущий большой смысловой нагрузки, стало сложно отличить от написанного человеком. В статье мы разберем подход к определению сгенерированных текстов. И заодно выясним, является ли, по мнению алгоритма, Пушкин (и другие деятели искусства) искусственной нейронной сетью. Суть подхода Суть подхода заключается в том, чтобы  выявить признаки, характеризующие сгенерированный текст, 
собрать обучающую выборку, 
с помощью одного из алгоритмов машинного обучения сделать предсказание. выявить признаки, характеризующие сгенерированный текст,  выявить признаки, характеризующие сгенерированный текст,  собрать обучающую выборку,  собрать обучающую выборку,  с помощью одного из алгоритмов машинного обучения сделать предсказание. с помощью одного из алгоритмов машинного обучения сделать предсказание. Текст токенизуется, затем переводится в вектор, строятся матрицы внимания с использованием переобученного BERT, строятся фильтрованные графы на основе признаков внимания. Затем определяются топологические и метрические признаки, которые направляются на вход алгоритму классификации. Если вы хотите подробнее прочитать про механизм внимания, то можно воспользоваться этой статьей. статьей статьей Данные для обучения Для обучения использовалось тексты из соревнования на Kaggle, сгенерированные нейронными сетями. тексты из соревнования на Kaggle тексты из соревнования на Kaggle А теперь рассмотрим механизм подробнее. ОСТОРОЖНО, МНОГО МАТЕМАТИКИ!) Все равно хочу увидеть Все равно хочу увидеть                                                                                   Результаты классификации по метрике accuracy В качестве алгоритма была использована логистическая регрессия, как наиболее просто интерпретируемый подход. Accuracy Топологические признаки: 0.6291
Штрихкодовые признаки: 0.6227
Метрические признаки: 0.6276
Все признаки: 0.6429 Топологические признаки: 0.6291 Топологические признаки: 0.6291 Штрихкодовые признаки: 0.6227 Штрихкодовые признаки: 0.6227 Метрические признаки: 0.6276 Метрические признаки: 0.6276 Все признаки: 0.6429 Все признаки: 0.6429 Проверяем великих писателей на сгенерированность текста  А.С. Пушкин Проверено текстов 5. Классифицировано как сгенерированные тексты - 3. Пример матрицы внимания.  Пример для строк «Мой дядя самых честных правил …» Классифицированы как сгенерированные нейронной сетью: 1.     Буря мглою небо кроет, вихри снежные крутя… 2.     Мой дядя самых честных правил … 3.     Последняя туча рассеянной бури! Одна ты несешься по ясной лазури …  Возьмем что-то более сложное и неочевидное В.В. Маяковский Проверено текстов 5. Классифицировано как сгенерированные тексты - 2. Пример матрицы внимания.  Пример для строк «Я волком выгрыз бы бюрократизм…» Классифицированы как сгенерированные нейронной сетью: 1. Били копыта, пели будто: — Гриб. Грабь. Гроб. Груб … 2. В шатрах, истертых ликов цвель … А.А. Блок Проверено текстов 5. Классифицировано как сгенерированные тексты - 0. Пример матрицы внимания.  Пример для строк “ночь, улица, фонарь, аптека …» Пока получилось не очень наглядно, тексты слишком длинные. Попробуем что-нибудь из современного, лично я всегда подозревал стихи группы Мельница в том, что они сгенерированы. Проверим это! Группа Мельница Проверено текстов 5. Классифицировано как сгенерированные тексты - 0. Пример матрицы внимания.  Пример для строк «Есть такие дороги – назад не ведут...»  Тут видно, что слова прилив и морская связаны. И напоследок немного русского рока.  И напоследок немного русского рока.  Машина времени Проверено текстов 5. Классифицировано как сгенерированные тексты - 0. Пример матрицы внимания.  Пример для строк «Крысы придумали мир для крыс…» В этом примере видно, как «внимание» сосредотачивается на повторяющихся словах.  Анализруем стихи, сгенерированные нейронной сетью Таким образом стихи, проанализированные алгоритмом, были верно классифицированы, за исключением 3 из 5 стихов Пушкина и 2 из 5 стихов Маяковского. Но кто знает – может это и не ошибка;) А может, дело в самой форме – стихотворения. Давайте попробуем взять стихи, сгенерированные нейронной сетью, и посмотреть, что скажет алгоритм. Сами текст мы возьмем из нашей предыдущей статьи – Используем нейросеть для генерации стихов в стиле «Евгения Онегина. Используем нейросеть для генерации стихов в стиле «Евгения Онегина Используем нейросеть для генерации стихов в стиле «Евгения Онегина Мы проанализировали 9 текстов, созданных нейронной сетью, и получили 8 верных предсказаний. Результаты можно найти под спойлером в таблице предсказаний. Итоговая таблица предсказаний. H - человек, М - машина. Итоговая таблица предсказаний. H - человек, М - машина.                                                                                                                                                                                                                                                                                                                                                     Выводы Мы рассмотрели алгоритм определения сгенерированных текстов, которые на «человеческий взгляд» выглядят весьма натурально. На данный момент подход дает прогноз с accuracy 0,64, что выше случайного предсказания. При этом алгоритм принял за сгенерированные нейронной сетью большинство из стихов Пушкина и почти половину стихов Маяковского. Как говорится – совпадение? не думаю …  Статья написана на основе работ 1, 2, 3 Александры Штаревой и Екатерины Артемовой. 1 1 2 2 3 3 Если вы хотите ознакомиться с кодом проекта, то это можно сделать по ссылке. ссылке ссылке А если хотите этот проект (или любой другой ваш проект) развернуть, захостить и протестировать, то можно воспользоваться нашим контейнерным Heroku-подобным облаком Amvera, с возможностью доставки обновлений через push в GIT. Для этого нужно зарегистрироваться, после чего на счет будет зачислено 1 т.р., и ввести до 5 декабря 2022 г. промокод HabrNNText, который зачислит еще 300 руб. на счет.  Amvera Amvera , ]]></text>
</doc>
